<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Chialisp Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Chialisp Blog Atom Feed"><title data-react-helmet="true">7 - Lifecycle of a Coin | Chialisp</title><meta data-react-helmet="true" property="og:url" content="https://chialisp.com/docs/coin_lifecycle"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="7 - Lifecycle of a Coin | Chialisp"><meta data-react-helmet="true" name="description" content="You should now understand how to create Chialisp puzzles that lock up coins with a particular set of rules.  You may be wondering how a coin gets locked up, where it is stored, how and when it gets spent, and who can spend it.  Let&#x27;s take a look at the steps a coin goes through from its creation to its destruction."><meta data-react-helmet="true" property="og:description" content="You should now understand how to create Chialisp puzzles that lock up coins with a particular set of rules.  You may be wondering how a coin gets locked up, where it is stored, how and when it gets spent, and who can spend it.  Let&#x27;s take a look at the steps a coin goes through from its creation to its destruction."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://chialisp.com/docs/coin_lifecycle"><link data-react-helmet="true" rel="alternate" href="https://chialisp.com/docs/coin_lifecycle" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://chialisp.com/docs/coin_lifecycle" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.524535a3.css">
<link rel="preload" href="/assets/js/styles.26f56164.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.f5fd9829.js" as="script">
<link rel="preload" href="/assets/js/main.48016fb5.js" as="script">
<link rel="preload" href="/assets/js/1.770ac2bf.js" as="script">
<link rel="preload" href="/assets/js/2.51d5087f.js" as="script">
<link rel="preload" href="/assets/js/3.377891e5.js" as="script">
<link rel="preload" href="/assets/js/1be78505.d5247ac1.js" as="script">
<link rel="preload" href="/assets/js/24.7aadb6e8.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.03b299c1.js" as="script">
<link rel="preload" href="/assets/js/17896441.1001ec9f.js" as="script">
<link rel="preload" href="/assets/js/30f7f086.e60daf10.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Chialisp</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a href="https://chia.net/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><a href="https://chia.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chia.net</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Chia-Network/chialisp-web" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Chialisp</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="https://chia.net/blog" target="_blank" rel="noopener noreferrer" class="menu__link">Blog</a></li><li class="menu__list-item"><a href="https://chia.net" target="_blank" rel="noopener noreferrer" class="menu__link">Chia.net</a></li><li class="menu__list-item"><a href="https://github.com/Chia-Network/chialisp-web" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">7 - Lifecycle of a Coin</h1></header><div class="markdown"><p>You should now understand how to create Chialisp puzzles that lock up coins with a particular set of rules.  You may be wondering how a coin gets locked up, where it is stored, how and when it gets spent, and who can spend it.  Let&#x27;s take a look at the steps a coin goes through from its creation to its destruction.</p><h2 id="farming-rewards">Farming Rewards</h2><p>As you probably know, farmers create the entirety of new value in Chia.  Every 30 seconds or so, a new block pops into existence that allows for a farmer to create a coin of thin air, in two amounts of a very specific ratio: 1 to 7 (farmer to pool).  Here are two actual farming rewards that were generated in block 10,000 of the blockchain:</p><pre><code class="language-json">[
  {
    &quot;amount&quot; : 1750000000000,
    &quot;parent_coin_info&quot; : &quot;0xccd5bb71183532bff220ba46c268991a0000000000000000000000000000270b&quot;,
    &quot;puzzle_hash&quot; : &quot;0x0b42a11b76d276f191026ae1a01c711cc0637e63d8ce0c2f62d6d079cc974920&quot;
  },
  {
    &quot;amount&quot; : 250000000000,
    &quot;parent_coin_info&quot; : &quot;0x3ff07eb358e8255a65c30a2dce0e5fbb0000000000000000000000000000270b&quot;,
    &quot;puzzle_hash&quot; : &quot;0x0b42a11b76d276f191026ae1a01c711cc0637e63d8ce0c2f62d6d079cc974920&quot;
  }
]
</code></pre><p><em>Fun fact: The geneis challenge is the hash of a bitcoin block around the time when the Chia network was launched and the message from Bram Cohen: &quot;\&quot;Operational error causes Fed payment system to crash\&quot; We stand on the shoulders of giants, now let&#x27;s get farming!&quot;</em></p><p>Notice that the <code>parent_coin_info</code> for both is a little strange.  Because they are created out of thin air, the coins are assigned a special value as their parent coin: one half of the &quot;genesis challenge&quot;, some filler zeroes, and the index of the block they are farmed in.</p><p>This information is usually not very relevant, but it is used in the pooling puzzles.  It&#x27;s also important to point out that since the genesis challenge is part of the parent info, and since the genesis challenge is different between mainnet and each testnet, it&#x27;s nearly impossible to end up with two identical coin ids. This is to prevent signature replay attacks: coins that are signed on testnet won&#x27;t be able to use the same signature on mainnet.</p><h2 id="spend-bundles">Spend Bundles</h2><p>Alright, so you&#x27;ve received some XCH and you want to deploy your first smart contract.  To do that, you&#x27;re first going to have to create a <strong>spend bundle</strong>.  A spend bundle is a very simple construct.  It is an object that contains exactly two things: a list of coin solutions and an aggregated signature.</p><p>A <strong>coin solution</strong> contains exactly three things: The coin you are trying to spend (parent_coin_info, amount, puzzle_hash like above), the puzzle reveal (needs to tree hash to the puzzle hash), and the solution.</p><p>The <strong>aggregated signature</strong> is a BLS signature and needs to be a signature of exactly the public key/message pairs that are output by the conditions from puzzles in the bundle.  You cannot aggregate extra signatures, nor can you leave out any.  If there are no AGG_SIG_ME or AGG_SIG_UNSAFE conditions that are output, the aggregated signature must be an empty signature which is a &quot;c&quot; followed 191 zeroes.</p><p>Once you have constructed a spend bundle, you can push it to the <code>/push_tx</code> RPC endpoint on a Chia full node.  Keep in mind a few things though:</p><ul><li>Unless you farm the block, you cannot guarantee if or when your spend bundle will make it to the network.  If two spends rely on each other some way, they must be in the same spend bundle (bound with signatures).</li><li>When using short absolute timelocks, make sure to leave in a reasonable amount of time for the bundle to reach the network.  Sometimes, due to high fee pressure, it may take a while for a low fee transaction to get in.  If your spend relies on having the coin available on the blockchain before the timelock passes, it&#x27;s not a guarantee, so make sure to leave in a good amount of time just in case.</li><li>Nothing technically keeps the spends in a spend bundle together except for the aggregated signature and announcement logic.  If you make a spend that does not assert an announcement from another coin in the spend AND does not require a signature, that spend can be excluded from the bundle by a malicious node or farmer.</li></ul><p>Remember that other nodes are handling this piece of data as well, and it&#x27;s probably best to assume that they will try to change everything that they can.  Make sure that if anything changes in a way you don&#x27;t like, the whole bundle will fail.</p><h2 id="fees-and-the-mempool">Fees and the mempool</h2><p>Once you create and push a spend bundle, your node will validate it and then start gossipping the information out to its peers.  </p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/Chia-Network/chialisp-web/edit/master/docs/coin_lifecycle.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#farming-rewards" class="table-of-contents__link">Farming Rewards</a></li><li><a href="#spend-bundles" class="table-of-contents__link">Spend Bundles</a></li><li><a href="#fees-and-the-mempool" class="table-of-contents__link">Fees and the mempool</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">CLVM Basics</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/coins_spends_and_wallets/">Coins, Spends and Wallets</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://keybase.io/team/chia_network.public" target="_blank" rel="noopener noreferrer" class="footer__link-item">Keybase</a></li><li class="footer__item"><a href="https://twitter.com/chia_project" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.chia.net/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/Chia-Network/clvm" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Chia Network Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/styles.26f56164.js"></script>
<script src="/assets/js/runtime~main.f5fd9829.js"></script>
<script src="/assets/js/main.48016fb5.js"></script>
<script src="/assets/js/1.770ac2bf.js"></script>
<script src="/assets/js/2.51d5087f.js"></script>
<script src="/assets/js/3.377891e5.js"></script>
<script src="/assets/js/1be78505.d5247ac1.js"></script>
<script src="/assets/js/24.7aadb6e8.js"></script>
<script src="/assets/js/935f2afb.03b299c1.js"></script>
<script src="/assets/js/17896441.1001ec9f.js"></script>
<script src="/assets/js/30f7f086.e60daf10.js"></script>
</body>
</html>