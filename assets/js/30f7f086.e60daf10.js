(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{80:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return u}));var a=n(3),o=n(7),r=(n(0),n(93)),i={id:"coin_lifecycle",title:"7 - Lifecycle of a Coin"},s={unversionedId:"coin_lifecycle",id:"coin_lifecycle",isDocsHomePage:!1,title:"7 - Lifecycle of a Coin",description:"You should now understand how to create Chialisp puzzles that lock up coins with a particular set of rules.  You may be wondering how a coin gets locked up, where it is stored, how and when it gets spent, and who can spend it.  Let's take a look at the steps a coin goes through from its creation to its destruction.",source:"@site/docs/coin_lifecycle.md",slug:"/coin_lifecycle",permalink:"/docs/coin_lifecycle",editUrl:"https://github.com/Chia-Network/chialisp-web/edit/master/docs/coin_lifecycle.md",version:"current"},c=[{value:"Farming Rewards",id:"farming-rewards",children:[]},{value:"Spend Bundles",id:"spend-bundles",children:[]},{value:"Fees and the mempool",id:"fees-and-the-mempool",children:[]}],l={toc:c};function u(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(r.a)("wrapper",Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(r.a)("p",null,"You should now understand how to create Chialisp puzzles that lock up coins with a particular set of rules.  You may be wondering how a coin gets locked up, where it is stored, how and when it gets spent, and who can spend it.  Let's take a look at the steps a coin goes through from its creation to its destruction."),Object(r.a)("h2",{id:"farming-rewards"},"Farming Rewards"),Object(r.a)("p",null,"As you probably know, farmers create the entirety of new value in Chia.  Every 30 seconds or so, a new block pops into existence that allows for a farmer to create a coin of thin air, in two amounts of a very specific ratio: 1 to 7 (farmer to pool).  Here are two actual farming rewards that were generated in block 10,000 of the blockchain:"),Object(r.a)("pre",null,Object(r.a)("code",{parentName:"pre",className:"language-json"},'[\n  {\n    "amount" : 1750000000000,\n    "parent_coin_info" : "0xccd5bb71183532bff220ba46c268991a0000000000000000000000000000270b",\n    "puzzle_hash" : "0x0b42a11b76d276f191026ae1a01c711cc0637e63d8ce0c2f62d6d079cc974920"\n  },\n  {\n    "amount" : 250000000000,\n    "parent_coin_info" : "0x3ff07eb358e8255a65c30a2dce0e5fbb0000000000000000000000000000270b",\n    "puzzle_hash" : "0x0b42a11b76d276f191026ae1a01c711cc0637e63d8ce0c2f62d6d079cc974920"\n  }\n]\n')),Object(r.a)("p",null,Object(r.a)("em",{parentName:"p"},'Fun fact: The geneis challenge is the hash of a bitcoin block around the time when the Chia network was launched and the message from Bram Cohen: "\\"Operational error causes Fed payment system to crash\\" We stand on the shoulders of giants, now let\'s get farming!"')),Object(r.a)("p",null,"Notice that the ",Object(r.a)("inlineCode",{parentName:"p"},"parent_coin_info"),' for both is a little strange.  Because they are created out of thin air, the coins are assigned a special value as their parent coin: one half of the "genesis challenge", some filler zeroes, and the index of the block they are farmed in.'),Object(r.a)("p",null,"This information is usually not very relevant, but it is used in the pooling puzzles.  It's also important to point out that since the genesis challenge is part of the parent info, and since the genesis challenge is different between mainnet and each testnet, it's nearly impossible to end up with two identical coin ids. This is to prevent signature replay attacks: coins that are signed on testnet won't be able to use the same signature on mainnet."),Object(r.a)("h2",{id:"spend-bundles"},"Spend Bundles"),Object(r.a)("p",null,"Alright, so you've received some XCH and you want to deploy your first smart contract.  To do that, you're first going to have to create a ",Object(r.a)("strong",{parentName:"p"},"spend bundle"),".  A spend bundle is a very simple construct.  It is an object that contains exactly two things: a list of coin solutions and an aggregated signature."),Object(r.a)("p",null,"A ",Object(r.a)("strong",{parentName:"p"},"coin solution")," contains exactly three things: The coin you are trying to spend (parent_coin_info, amount, puzzle_hash like above), the puzzle reveal (needs to tree hash to the puzzle hash), and the solution."),Object(r.a)("p",null,"The ",Object(r.a)("strong",{parentName:"p"},"aggregated signature"),' is a BLS signature and needs to be a signature of exactly the public key/message pairs that are output by the conditions from puzzles in the bundle.  You cannot aggregate extra signatures, nor can you leave out any.  If there are no AGG_SIG_ME or AGG_SIG_UNSAFE conditions that are output, the aggregated signature must be an empty signature which is a "c" followed 191 zeroes.'),Object(r.a)("p",null,"Once you have constructed a spend bundle, you can push it to the ",Object(r.a)("inlineCode",{parentName:"p"},"/push_tx")," RPC endpoint on a Chia full node.  Keep in mind a few things though:"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"Unless you farm the block, you cannot guarantee if or when your spend bundle will make it to the network.  If two spends rely on each other some way, they must be in the same spend bundle (bound with signatures)."),Object(r.a)("li",{parentName:"ul"},"When using short absolute timelocks, make sure to leave in a reasonable amount of time for the bundle to reach the network.  Sometimes, due to high fee pressure, it may take a while for a low fee transaction to get in.  If your spend relies on having the coin available on the blockchain before the timelock passes, it's not a guarantee, so make sure to leave in a good amount of time just in case."),Object(r.a)("li",{parentName:"ul"},"Nothing technically keeps the spends in a spend bundle together except for the aggregated signature and announcement logic.  If you make a spend that does not assert an announcement from another coin in the spend AND does not require a signature, that spend can be excluded from the bundle by a malicious node or farmer.")),Object(r.a)("p",null,"Remember that other nodes are handling this piece of data as well, and it's probably best to assume that they will try to change everything that they can.  Make sure that if anything changes in a way you don't like, the whole bundle will fail."),Object(r.a)("h2",{id:"fees-and-the-mempool"},"Fees and the mempool"),Object(r.a)("p",null,"Once you create and push a spend bundle, your node will validate it and then start gossipping the information out to its peers.  "))}u.isMDXComponent=!0},93:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(0),o=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=o.a.createContext({}),u=function(e){var t=o.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},h={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},d=o.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,i=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),d=u(n),p=a,f=d["".concat(i,".").concat(p)]||d[p]||h[p]||r;return n?o.a.createElement(f,s(s({ref:t},l),{},{components:n})):o.a.createElement(f,s({ref:t},l))}));function p(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var l=2;l<r;l++)i[l]=n[l];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"}}]);